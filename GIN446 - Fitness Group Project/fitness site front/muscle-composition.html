<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Muscle Body Viewer</title>
  <link rel="stylesheet" href="style.css">
</head>
  <header class="site-header">
    <div class="logo">Dream<span>FIT</span></div>
    <nav class="main-nav">
    <a href="../index.html">Home</a>
      <a href="bmi.html">BMI</a>
      <a href="bodyfat.html">Body Fat %</a>
      <a href="workout.html">Workouts</a>
      <a href="nutrition.html">Nutrition</a>
      <a href="muscle-composition.html" class="active">Muscle Viewer</a>
      <a href="profile.html">Profile</a>
<button id="logout-btn" class="pill-btn">Logout</button>
<script type="module" src="../../firebase/signout.js"></script>
    </nav>
  </header>

  <main class="page-wide">
    <h1>3D Muscle Body Viewer</h1>
    <p class="page-intro">
      Explore the human muscular system in realistic 3D. Drag on the model to rotate it,
      zoom with the mouse wheel, and use the buttons to learn about each muscle group.
    </p>

    <div class="viewer-container">
      <div class="controls-panel">
        <h3>üí™ Muscle Groups</h3>
        <div class="muscle-list">
          <button class="muscle-btn" data-muscle="biceps">Biceps (3 parts)</button>
          <button class="muscle-btn" data-muscle="triceps">Triceps (3 parts)</button>
          <button class="muscle-btn" data-muscle="chest">Chest (Pectorals)</button>
          <button class="muscle-btn" data-muscle="shoulders">Shoulders (Deltoids)</button>
          <button class="muscle-btn" data-muscle="abs">Abs (6-pack)</button>
          <button class="muscle-btn" data-muscle="quadriceps">Quadriceps (4 parts)</button>
          <button class="muscle-btn" data-muscle="hamstrings">Hamstrings (3 parts)</button>
          <button class="muscle-btn" data-muscle="calves">Calves (2 parts)</button>
          <button class="muscle-btn" data-muscle="back">Back (Lats)</button>
          <button class="muscle-btn" data-muscle="traps">Trapezius (3 parts)</button>
        </div>

        <div class="water-control">
          <h3>üíß Body Composition</h3>
          <p>The human body is composed of approximately 70% water.</p>
          <button id="water-btn" class="btn primary full-width">Show Water (70%)</button>
          <button id="reset-btn" class="btn ghost full-width">Reset View</button>
        </div>
      </div>

      <div id="canvas-container">
        <!-- DIRECT Sketchfab embed -->
        <iframe
          id="api-frame"
          title="3D Human Muscular System"
          src="https://sketchfab.com/models/4f258907dfb6477aa9bf4dfb5833a797/embed?autostart=1&autospin=0.3&ui_infos=0&ui_watermark=0&ui_controls=1&transparent=1"
          allow="autoplay; fullscreen; xr-spatial-tracking; gyroscope; accelerometer">
        </iframe>

        <!-- loading overlay -->
        <div class="loading-3d" id="loading-3d">
          <div class="spinner"></div>
          <div>Loading 3D muscular body...</div>
        </div>

        <!-- muscle info box -->
        <div id="muscle-info" class="muscle-info">
          <h4 id="muscle-name">Muscle Name</h4>
          <ul id="muscle-parts"></ul>
        </div>

        <!-- water overlay -->
        <div id="water-overlay" class="water-overlay">
          <div class="water-percentage">70%</div>
        </div>

        <div class="status-info">
          üñ±Ô∏è Drag to rotate ‚Ä¢ üñ±Ô∏è Wheel to zoom
        </div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <p>&copy; 2025 DreamFIT. Educational 3D Muscle Viewer.</p>
  </footer>

  <script>
    // ===== muscle data (same as before) =====
    const muscleData = {
      biceps: {
        name: 'Biceps Brachii',
        parts: ['Long head (outer)', 'Short head (inner)', 'Brachialis (deep)']
      },
      triceps: {
        name: 'Triceps Brachii',
        parts: ['Long head', 'Lateral head', 'Medial head']
      },
      chest: {
        name: 'Pectoralis Major',
        parts: ['Upper (clavicular)', 'Middle (sternal)', 'Lower (abdominal)']
      },
      shoulders: {
        name: 'Deltoids',
        parts: ['Anterior (front)', 'Lateral (side)', 'Posterior (rear)']
      },
      abs: {
        name: 'Rectus Abdominis',
        parts: ['Upper abs', 'Middle abs', 'Lower abs']
      },
      quadriceps: {
        name: 'Quadriceps',
        parts: ['Rectus femoris', 'Vastus lateralis', 'Vastus medialis', 'Vastus intermedius']
      },
      hamstrings: {
        name: 'Hamstrings',
        parts: ['Biceps femoris', 'Semitendinosus', 'Semimembranosus']
      },
      calves: {
        name: 'Calves',
        parts: ['Gastrocnemius (outer)', 'Soleus (deep)']
      },
      back: {
        name: 'Latissimus Dorsi',
        parts: ['Upper lats', 'Middle lats', 'Lower lats']
      },
      traps: {
        name: 'Trapezius',
        parts: ['Upper traps', 'Middle traps', 'Lower traps']
      }
    };

    const muscleButtons = document.querySelectorAll('.muscle-btn');
    const muscleInfo   = document.getElementById('muscle-info');
    const muscleNameEl = document.getElementById('muscle-name');
    const musclePartsEl = document.getElementById('muscle-parts');
    const waterBtn = document.getElementById('water-btn');
    const waterOverlay = document.getElementById('water-overlay');
    const loading3D = document.getElementById('loading-3d');
    const iframe = document.getElementById('api-frame');

    let currentActiveMuscle = null;
    let waterActive = false;

    // hide loading when iframe finished
    iframe.addEventListener('load', () => {
      loading3D.style.display = 'none';
    });

    function showMuscleInfo(key) {
      const data = muscleData[key];
      if (!data) return;
      muscleNameEl.textContent = data.name;
      musclePartsEl.innerHTML = '';
      data.parts.forEach(p => {
        const li = document.createElement('li');
        li.textContent = p;
        musclePartsEl.appendChild(li);
      });
      muscleInfo.classList.add('visible');
    }

    function hideMuscleInfo() {
      muscleInfo.classList.remove('visible');
    }

    muscleButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const key = btn.dataset.muscle;
        if (currentActiveMuscle === key) {
          btn.classList.remove('active');
          currentActiveMuscle = null;
          hideMuscleInfo();
        } else {
          muscleButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentActiveMuscle = key;
          showMuscleInfo(key);
        }
      });
    });

    // water overlay
    waterBtn.addEventListener('click', () => {
      waterActive = !waterActive;
      if (waterActive) {
        waterOverlay.style.height = '70%';
        waterOverlay.classList.add('active');
        waterBtn.textContent = 'Hide Water';
      } else {
        waterOverlay.style.height = '0%';
        waterOverlay.classList.remove('active');
        waterBtn.textContent = 'Show Water (70%)';
      }
    });

    // reset view (just UI + overlay; iframe camera is controlled by user)
    document.getElementById('reset-btn').addEventListener('click', () => {
      muscleButtons.forEach(b => b.classList.remove('active'));
      currentActiveMuscle = null;
      hideMuscleInfo();
      waterActive = false;
      waterOverlay.style.height = '0%';
      waterOverlay.classList.remove('active');
      waterBtn.textContent = 'Show Water (70%)';
    });
  </script>
  <script type="module" src="../../firebase/state_listener.js"></script>
</body>
</html>